<div class="notes-container">
  <div class="container">
    <!-- Header -->
    <header class="page-header">
      <div class="header-content">
        <div class="back-btn" routerLink="/dashboard">
          <i class="back-icon">‚Üê</i>
          <span>Back to Dashboard</span>
        </div>
        <h1 class="page-title">Smart Notes</h1>
        <p class="page-subtitle">Organize your thoughts and study materials</p>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <div class="content-grid">
        <!-- Notes Form -->
        <div class="form-section">
          <div class="form-card">
            <div class="form-header">
              <h3 class="form-title">{{ isEditing ? 'Edit Note' : 'Create New Note' }}</h3>
              <p class="form-subtitle">{{ isEditing ? 'Update your note' : 'Add a new note to your collection' }}</p>
            </div>

            <form [formGroup]="notesForm" (ngSubmit)="onSubmit()" class="notes-form">
              <!-- Title -->
              <div class="form-group">
                <label class="form-label">Note Title</label>
                <input 
                  type="text" 
                  formControlName="title"
                  placeholder="Enter note title..."
                  class="form-input"
                  [class.error]="notesForm.get('title')?.invalid && notesForm.get('title')?.touched" />
                <div class="error-message" *ngIf="notesForm.get('title')?.invalid && notesForm.get('title')?.touched">
                  <span *ngIf="notesForm.get('title')?.errors?.['required']">Title is required</span>
                  <span *ngIf="notesForm.get('title')?.errors?.['minlength']">Title must be at least 3 characters</span>
                </div>
              </div>

              <!-- Content -->
              <div class="form-group">
                <label class="form-label">Note Content</label>
                <textarea 
                  formControlName="content"
                  placeholder="Write your note content here..."
                  class="form-textarea"
                  rows="6"
                  [class.error]="notesForm.get('content')?.invalid && notesForm.get('content')?.touched"></textarea>
                <div class="error-message" *ngIf="notesForm.get('content')?.invalid && notesForm.get('content')?.touched">
                  <span *ngIf="notesForm.get('content')?.errors?.['required']">Content is required</span>
                  <span *ngIf="notesForm.get('content')?.errors?.['minlength']">Content must be at least 10 characters</span>
                </div>
              </div>

              <!-- Category and Color -->
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label">Category</label>
                  <select formControlName="category" class="form-select">
                    <option *ngFor="let category of categories" [value]="category.value">
                      {{ getCategoryIcon(category.value) }} {{ category.label }}
                    </option>
                  </select>
                </div>

                <div class="form-group">
                  <label class="form-label">Color</label>
                  <div class="color-picker">
                    <div 
                      *ngFor="let color of colors" 
                      class="color-option"
                      [class.selected]="notesForm.get('color')?.value === color.value"
                      [style.background-color]="color.value"
                      (click)="notesForm.patchValue({ color: color.value })"
                      [title]="color.name">
                    </div>
                  </div>
                </div>
              </div>

              <!-- Tags -->
              <div class="form-group">
                <label class="form-label">Tags (comma separated)</label>
                <input 
                  type="text" 
                  formControlName="tags"
                  placeholder="e.g., angular, study, important"
                  class="form-input" />
              </div>

              <!-- Form Actions -->
              <div class="form-actions">
                <button type="button" 
                        class="btn btn-secondary" 
                        (click)="resetForm()"
                        [disabled]="!isEditing">
                  Cancel
                </button>
                <button type="submit" 
                        class="btn btn-primary"
                        [disabled]="notesForm.invalid">
                  {{ isEditing ? 'Update Note' : 'Create Note' }}
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Notes List -->
        <div class="notes-section">
          <!-- Search and Filters -->
          <div class="filters-card">
            <div class="search-container">
              <div class="search-box">
                <i class="search-icon">üîç</i>
                <input 
                  type="text" 
                  [(ngModel)]="searchQuery"
                  (input)="onSearchChange()"
                  placeholder="Search notes..."
                  class="search-input" />
              </div>
            </div>

            <div class="filter-controls">
              <div class="filter-group">
                <label class="filter-label">Category</label>
                <select 
                  [(ngModel)]="selectedCategory"
                  (change)="onCategoryChange()"
                  class="filter-select">
                  <option *ngFor="let category of categories" [value]="category.value">
                    {{ getCategoryIcon(category.value) }} {{ category.label }}
                  </option>
                </select>
              </div>

              <div class="filter-group">
                <label class="filter-label">Sort By</label>
                <select 
                  [(ngModel)]="sortBy"
                  (change)="onSortChange()"
                  class="filter-select">
                  <option value="updatedAt">Last Updated</option>
                  <option value="createdAt">Date Created</option>
                  <option value="title">Title</option>
                </select>
              </div>

              <div class="filter-group">
                <label class="filter-label">Order</label>
                <select 
                  [(ngModel)]="sortOrder"
                  (change)="onSortChange()"
                  class="filter-select">
                  <option value="desc">Newest First</option>
                  <option value="asc">Oldest First</option>
                </select>
              </div>

              <button class="btn btn-outline" (click)="exportNotes()">
                <i class="export-icon">üì§</i>
                Export
              </button>
            </div>
          </div>

          <!-- Notes Grid -->
          <div class="notes-grid">
            <div class="empty-state" *ngIf="filteredNotes.length === 0">
              <i class="empty-icon">üìù</i>
              <p class="empty-text">No notes found</p>
              <p class="empty-hint">{{ searchQuery ? 'Try adjusting your search' : 'Create your first note' }}</p>
            </div>

            <div class="note-card" 
                 *ngFor="let note of filteredNotes"
                 [style.border-left-color]="note.color">
              <div class="note-header">
                <div class="note-title">{{ note.title }}</div>
                <div class="note-actions">
                  <button class="action-btn pin-btn" 
                          [class.pinned]="note.isPinned"
                          (click)="pinNote(note)"
                          [title]="note.isPinned ? 'Unpin note' : 'Pin note'">
                    üìå
                  </button>
                  <button class="action-btn edit-btn" (click)="editNote(note)" title="Edit note">
                    ‚úèÔ∏è
                  </button>
                  <button class="action-btn delete-btn" (click)="deleteNote(note)" title="Delete note">
                    üóëÔ∏è
                  </button>
                </div>
              </div>

              <div class="note-content">
                <p class="note-text">{{ note.content }}</p>
              </div>

              <div class="note-footer">
                <div class="note-meta">
                  <span class="note-category">
                    {{ getCategoryIcon(note.category) }} {{ note.category }}
                  </span>
                  <span class="note-date">{{ formatDate(note.updatedAt) }}</span>
                </div>
                <div class="note-tags" *ngIf="note.tags.length > 0">
                  <span class="tag" *ngFor="let tag of note.tags">{{ tag }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
